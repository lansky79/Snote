<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æŠ¥è¡¨ä¸­å¿ƒ - æºè¸”ç§‘æŠ€é›†æˆäº§å“å¼€å‘ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/common.css" />
  </head>
  <body>
    <!-- å·¦ä¾§å¯¼èˆªæ  -->
    <nav class="sidebar">
      <div class="sidebar-header">
        <div class="system-title">
          <div class="company-name">æºè¸”ç§‘æŠ€</div>
          <div class="system-name">é›†æˆäº§å“å¼€å‘ç®¡ç†ç³»ç»Ÿ</div>
        </div>
      </div>
      <div class="nav-menu">
        <a href="index.html">é¡¹ç›®æ¦‚è§ˆ</a>
        <a href="dashboard.html">æ•°æ®åˆ†æ</a>
        <a href="team.html">å›¢é˜Ÿåä½œ</a>
        <a href="stages.html">é˜¶æ®µç®¡ç†</a>
        <a href="dcp.html">DCPè¯„å®¡</a>
        <a href="deliverables.html">äº¤ä»˜ç‰©ç®¡ç†</a>
        <a href="reports.html">æŠ¥è¡¨ä¸­å¿ƒ</a>
        <a href="users.html">ç”¨æˆ·ç®¡ç†</a>
        <a href="help.html">å¸®åŠ©ä¸­å¿ƒ</a>
        <a href="settings.html">ç³»ç»Ÿè®¾ç½®</a>
        <a href="#" onclick="logout()" class="logout">é€€å‡º</a>
      </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="main-content">


      <!-- æŠ¥è¡¨åˆ†ç±» -->
      <div class="grid grid-4" style="margin-bottom: 30px">
        <div class="stat-card" onclick="showReportCategory('project')">
          <div style="font-size: 2em; margin-bottom: 10px">ğŸ“Š</div>
          <div class="stat-label">é¡¹ç›®æŠ¥è¡¨</div>
          <div style="color: #666; font-size: 0.8em; margin-top: 5px">
            5ä¸ªæŠ¥è¡¨
          </div>
        </div>
        <div class="stat-card" onclick="showReportCategory('team')">
          <div style="font-size: 2em; margin-bottom: 10px">ğŸ‘¥</div>
          <div class="stat-label">å›¢é˜ŸæŠ¥è¡¨</div>
          <div style="color: #666; font-size: 0.8em; margin-top: 5px">
            3ä¸ªæŠ¥è¡¨
          </div>
        </div>
        <div class="stat-card" onclick="showReportCategory('financial')">
          <div style="font-size: 2em; margin-bottom: 10px">ğŸ’°</div>
          <div class="stat-label">è´¢åŠ¡æŠ¥è¡¨</div>
          <div style="color: #666; font-size: 0.8em; margin-top: 5px">
            4ä¸ªæŠ¥è¡¨
          </div>
        </div>
        <div class="stat-card" onclick="showReportCategory('quality')">
          <div style="font-size: 2em; margin-bottom: 10px">âœ…</div>
          <div class="stat-label">è´¨é‡æŠ¥è¡¨</div>
          <div style="color: #666; font-size: 0.8em; margin-top: 5px">
            3ä¸ªæŠ¥è¡¨
          </div>
        </div>
      </div>

      <!-- æŠ¥è¡¨åˆ—è¡¨ -->
      <div class="card">
        <div style="display: flex; justify-content: flex-end; gap: 10px; margin-bottom: 15px;">
            <select
              id="reportFilter"
              onchange="filterReports()"
              style="padding: 8px; border: 1px solid #ddd; border-radius: 4px"
            >
              <option value="all">å…¨éƒ¨æŠ¥è¡¨</option>
              <option value="project">é¡¹ç›®æŠ¥è¡¨</option>
              <option value="team">å›¢é˜ŸæŠ¥è¡¨</option>
              <option value="financial">è´¢åŠ¡æŠ¥è¡¨</option>
              <option value="quality">è´¨é‡æŠ¥è¡¨</option>
            </select>
            <button
              class="btn btn-primary"
              onclick="showAlert('è‡ªå®šä¹‰æŠ¥è¡¨åŠŸèƒ½å¼€å‘ä¸­')"
            >
              è‡ªå®šä¹‰æŠ¥è¡¨
            </button>
          </div>
        </div>
        <div class="card-content">
          <div id="reports-container" class="grid grid-3">
            <!-- æŠ¥è¡¨å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          </div>
        </div>
      </div>
    </main>

    <!-- å¼•å…¥è„šæœ¬ -->
    <script src="js/data.js"></script>
    <script src="js/common.js"></script>
    <script>
      // æŠ¥è¡¨æ•°æ®
      var reportsData = [
        // é¡¹ç›®æŠ¥è¡¨
        {
          id: "rpt_001",
          name: "é¡¹ç›®è¿›åº¦æ±‡æ€»æŠ¥è¡¨",
          category: "project",
          description: "å±•ç¤ºæ‰€æœ‰é¡¹ç›®çš„è¿›åº¦æƒ…å†µå’Œé˜¶æ®µåˆ†å¸ƒ",
          icon: "ğŸ“ˆ",
          lastGenerated: "2024-02-20",
          frequency: "æ¯æ—¥æ›´æ–°",
        },
        {
          id: "rpt_002",
          name: "é¡¹ç›®é¢„ç®—æ‰§è¡ŒæŠ¥è¡¨",
          category: "project",
          description: "åˆ†æé¡¹ç›®é¢„ç®—ä½¿ç”¨æƒ…å†µå’Œæˆæœ¬æ§åˆ¶",
          icon: "ğŸ’¹",
          lastGenerated: "2024-02-19",
          frequency: "æ¯å‘¨æ›´æ–°",
        },
        {
          id: "rpt_003",
          name: "é¡¹ç›®é£é™©è¯„ä¼°æŠ¥è¡¨",
          category: "project",
          description: "è¯†åˆ«å’Œè¯„ä¼°é¡¹ç›®é£é™©ç­‰çº§",
          icon: "âš ï¸",
          lastGenerated: "2024-02-18",
          frequency: "æ¯æœˆæ›´æ–°",
        },
        {
          id: "rpt_004",
          name: "é¡¹ç›®äº¤ä»˜ç‰©ç»Ÿè®¡æŠ¥è¡¨",
          category: "project",
          description: "ç»Ÿè®¡å„é¡¹ç›®äº¤ä»˜ç‰©å®Œæˆæƒ…å†µ",
          icon: "ğŸ“‹",
          lastGenerated: "2024-02-20",
          frequency: "æ¯æ—¥æ›´æ–°",
        },
        {
          id: "rpt_005",
          name: "é¡¹ç›®é‡Œç¨‹ç¢‘æŠ¥è¡¨",
          category: "project",
          description: "è·Ÿè¸ªé¡¹ç›®å…³é”®é‡Œç¨‹ç¢‘è¾¾æˆæƒ…å†µ",
          icon: "ğŸ¯",
          lastGenerated: "2024-02-17",
          frequency: "æ¯å‘¨æ›´æ–°",
        },

        // å›¢é˜ŸæŠ¥è¡¨
        {
          id: "rpt_006",
          name: "å›¢é˜Ÿå·¥ä½œè´Ÿè½½æŠ¥è¡¨",
          category: "team",
          description: "åˆ†æå›¢é˜Ÿæˆå‘˜å·¥ä½œè´Ÿè½½åˆ†å¸ƒ",
          icon: "ğŸ‘¤",
          lastGenerated: "2024-02-20",
          frequency: "æ¯æ—¥æ›´æ–°",
        },
        {
          id: "rpt_007",
          name: "å›¢é˜Ÿç»©æ•ˆè¯„ä¼°æŠ¥è¡¨",
          category: "team",
          description: "è¯„ä¼°å›¢é˜Ÿæˆå‘˜å·¥ä½œç»©æ•ˆ",
          icon: "ğŸ†",
          lastGenerated: "2024-02-15",
          frequency: "æ¯æœˆæ›´æ–°",
        },
        {
          id: "rpt_008",
          name: "å›¢é˜ŸæŠ€èƒ½åˆ†ææŠ¥è¡¨",
          category: "team",
          description: "åˆ†æå›¢é˜ŸæŠ€èƒ½ç»“æ„å’Œç¼ºå£",
          icon: "ğŸ“",
          lastGenerated: "2024-02-10",
          frequency: "æ¯å­£åº¦æ›´æ–°",
        },

        // è´¢åŠ¡æŠ¥è¡¨
        {
          id: "rpt_009",
          name: "é¡¹ç›®æˆæœ¬åˆ†ææŠ¥è¡¨",
          category: "financial",
          description: "è¯¦ç»†åˆ†æå„é¡¹ç›®æˆæœ¬æ„æˆ",
          icon: "ğŸ’°",
          lastGenerated: "2024-02-19",
          frequency: "æ¯å‘¨æ›´æ–°",
        },
        {
          id: "rpt_010",
          name: "é¢„ç®—æ‰§è¡Œæƒ…å†µæŠ¥è¡¨",
          category: "financial",
          description: "ç›‘æ§é¢„ç®—æ‰§è¡Œå’Œåå·®åˆ†æ",
          icon: "ğŸ“Š",
          lastGenerated: "2024-02-18",
          frequency: "æ¯æœˆæ›´æ–°",
        },
        {
          id: "rpt_011",
          name: "ROIæŠ•èµ„å›æŠ¥åˆ†æ",
          category: "financial",
          description: "è®¡ç®—é¡¹ç›®æŠ•èµ„å›æŠ¥ç‡",
          icon: "ğŸ“ˆ",
          lastGenerated: "2024-02-15",
          frequency: "æ¯å­£åº¦æ›´æ–°",
        },
        {
          id: "rpt_012",
          name: "æˆæœ¬æ•ˆç›Šå¯¹æ¯”æŠ¥è¡¨",
          category: "financial",
          description: "å¯¹æ¯”ä¸åŒé¡¹ç›®çš„æˆæœ¬æ•ˆç›Š",
          icon: "âš–ï¸",
          lastGenerated: "2024-02-12",
          frequency: "æ¯æœˆæ›´æ–°",
        },

        // è´¨é‡æŠ¥è¡¨
        {
          id: "rpt_013",
          name: "DCPè¯„å®¡é€šè¿‡ç‡æŠ¥è¡¨",
          category: "quality",
          description: "ç»Ÿè®¡å„é˜¶æ®µDCPè¯„å®¡é€šè¿‡æƒ…å†µ",
          icon: "âœ…",
          lastGenerated: "2024-02-20",
          frequency: "æ¯å‘¨æ›´æ–°",
        },
        {
          id: "rpt_014",
          name: "è´¨é‡é—®é¢˜è·Ÿè¸ªæŠ¥è¡¨",
          category: "quality",
          description: "è·Ÿè¸ªé¡¹ç›®è´¨é‡é—®é¢˜å’Œè§£å†³æƒ…å†µ",
          icon: "ğŸ”",
          lastGenerated: "2024-02-18",
          frequency: "æ¯æ—¥æ›´æ–°",
        },
        {
          id: "rpt_015",
          name: "äº¤ä»˜ç‰©è´¨é‡è¯„ä¼°æŠ¥è¡¨",
          category: "quality",
          description: "è¯„ä¼°äº¤ä»˜ç‰©è´¨é‡æ°´å¹³",
          icon: "ğŸ“",
          lastGenerated: "2024-02-16",
          frequency: "æ¯å‘¨æ›´æ–°",
        },
      ];

      // æ¸²æŸ“æŠ¥è¡¨åˆ—è¡¨
      function renderReports(filter = "all") {
        var container = document.getElementById("reports-container");
        var filteredReports =
          filter === "all"
            ? reportsData
            : reportsData.filter(function (r) {
                return r.category === filter;
              });
        var html = "";

        for (var i = 0; i < filteredReports.length; i++) {
          var report = filteredReports[i];

          html +=
            '<div class="card" style="margin: 0; cursor: pointer; transition: transform 0.2s;" onclick="generateReport(\'' +
            report.id +
            "')\">";
          html += '<div style="text-align: center; margin-bottom: 15px;">';
          html +=
            '<div style="font-size: 3em; margin-bottom: 10px;">' +
            report.icon +
            "</div>";
          html +=
            '<h4 style="margin: 0; color: #2c3e50; font-size: 1.1em;">' +
            report.name +
            "</h4>";
          html += "</div>";
          html +=
            '<p style="color: #666; margin-bottom: 15px; font-size: 0.9em; line-height: 1.4; text-align: center;">' +
            report.description +
            "</p>";
          html +=
            '<div style="border-top: 1px solid #e9ecef; padding-top: 15px; font-size: 0.8em; color: #999;">';
          html +=
            '<div style="display: flex; justify-content: space-between; margin-bottom: 5px;">';
          html += "<span>æ›´æ–°é¢‘ç‡:</span>";
          html += "<span>" + report.frequency + "</span>";
          html += "</div>";
          html +=
            '<div style="display: flex; justify-content: space-between;">';
          html += "<span>æœ€åç”Ÿæˆ:</span>";
          html += "<span>" + formatDate(report.lastGenerated) + "</span>";
          html += "</div>";
          html += "</div>";
          html += '<div style="margin-top: 15px; display: flex; gap: 8px;">';
          html +=
            '<button class="btn btn-outline" onclick="event.stopPropagation(); previewReport(\'' +
            report.id +
            '\')" style="flex: 1; padding: 6px 10px; font-size: 0.8em;">é¢„è§ˆ</button>';
          html +=
            '<button class="btn btn-primary" onclick="event.stopPropagation(); generateReport(\'' +
            report.id +
            '\')" style="flex: 1; padding: 6px 10px; font-size: 0.8em;">ç”Ÿæˆ</button>';
          html += "</div>";
          html += "</div>";
        }

        container.innerHTML = html;
      }

      // æ˜¾ç¤ºæŠ¥è¡¨åˆ†ç±»
      function showReportCategory(category) {
        document.getElementById("reportFilter").value = category;
        filterReports();
      }

      // è¿‡æ»¤æŠ¥è¡¨
      function filterReports() {
        var filter = document.getElementById("reportFilter").value;
        renderReports(filter);
      }

      // é¢„è§ˆæŠ¥è¡¨
      function previewReport(reportId) {
        var report = reportsData.find(function (r) {
          return r.id === reportId;
        });
        if (!report) return;

        var content = "<div>";
        content +=
          '<h4 style="color: #2c3e50; margin-bottom: 20px;">' +
          report.name +
          " - é¢„è§ˆ</h4>";
        content += '<div style="text-align: center; margin-bottom: 20px;">';
        content +=
          '<div style="font-size: 4em; margin-bottom: 10px;">' +
          report.icon +
          "</div>";
        content +=
          '<p style="color: #666; line-height: 1.6;">' +
          report.description +
          "</p>";
        content += "</div>";

        // æ¨¡æ‹ŸæŠ¥è¡¨æ•°æ®é¢„è§ˆ
        content +=
          '<div style="background: #f8f9fa; padding: 20px; border-radius: 6px; margin-bottom: 20px;">';
        content +=
          '<h5 style="color: #2c3e50; margin-bottom: 15px;">æŠ¥è¡¨æ•°æ®é¢„è§ˆ</h5>';

        if (report.category === "project") {
          content +=
            '<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; text-align: center;">';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #3498db;">5</div><div style="font-size: 0.8em; color: #666;">æ€»é¡¹ç›®æ•°</div></div>';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #27ae60;">3</div><div style="font-size: 0.8em; color: #666;">è¿›è¡Œä¸­</div></div>';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #f39c12;">67%</div><div style="font-size: 0.8em; color: #666;">å¹³å‡è¿›åº¦</div></div>';
          content += "</div>";
        } else if (report.category === "team") {
          content +=
            '<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; text-align: center;">';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #3498db;">6</div><div style="font-size: 0.8em; color: #666;">å›¢é˜Ÿæˆå‘˜</div></div>';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #27ae60;">78%</div><div style="font-size: 0.8em; color: #666;">å¹³å‡è´Ÿè½½</div></div>';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #f39c12;">42</div><div style="font-size: 0.8em; color: #666;">æ€»ä»»åŠ¡æ•°</div></div>';
          content += "</div>";
        } else if (report.category === "financial") {
          content +=
            '<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; text-align: center;">';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #3498db;">685ä¸‡</div><div style="font-size: 0.8em; color: #666;">æ€»é¢„ç®—</div></div>';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #27ae60;">412ä¸‡</div><div style="font-size: 0.8em; color: #666;">å·²ä½¿ç”¨</div></div>';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #f39c12;">60%</div><div style="font-size: 0.8em; color: #666;">æ‰§è¡Œç‡</div></div>';
          content += "</div>";
        } else if (report.category === "quality") {
          content +=
            '<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; text-align: center;">';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #3498db;">4</div><div style="font-size: 0.8em; color: #666;">æ€»è¯„å®¡æ•°</div></div>';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #27ae60;">100%</div><div style="font-size: 0.8em; color: #666;">é€šè¿‡ç‡</div></div>';
          content +=
            '<div><div style="font-size: 1.5em; font-weight: bold; color: #f39c12;">5</div><div style="font-size: 0.8em; color: #666;">äº¤ä»˜ç‰©æ•°</div></div>';
          content += "</div>";
        }

        content += "</div>";

        content +=
          '<div style="color: #999; font-size: 0.8em; text-align: center;">';
        content += "* è¿™æ˜¯æŠ¥è¡¨æ•°æ®é¢„è§ˆï¼Œå®é™…æŠ¥è¡¨åŒ…å«æ›´è¯¦ç»†çš„æ•°æ®å’Œå›¾è¡¨";
        content += "</div>";

        content += "</div>";

        showModal("æŠ¥è¡¨é¢„è§ˆ", content);
      }

      // ç”ŸæˆæŠ¥è¡¨
      function generateReport(reportId) {
        var report = reportsData.find(function (r) {
          return r.id === reportId;
        });
        if (!report) return;

        // æ˜¾ç¤ºç”Ÿæˆè¿›åº¦
        showSuccessMessage("æ­£åœ¨ç”ŸæˆæŠ¥è¡¨: " + report.name);

        // æ¨¡æ‹ŸæŠ¥è¡¨ç”Ÿæˆè¿‡ç¨‹
        setTimeout(function () {
          var content = "<div>";
          content +=
            '<h4 style="color: #2c3e50; margin-bottom: 20px;">' +
            report.name +
            "</h4>";
          content += '<div style="text-align: center; margin-bottom: 25px;">';
          content +=
            '<div style="font-size: 4em; margin-bottom: 15px;">âœ…</div>';
          content +=
            '<div style="color: #27ae60; font-size: 1.2em; font-weight: bold; margin-bottom: 10px;">æŠ¥è¡¨ç”ŸæˆæˆåŠŸï¼</div>';
          content +=
            '<div style="color: #666;">æŠ¥è¡¨å·²ç”Ÿæˆå®Œæˆï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä»¥ä¸‹æ“ä½œï¼š</div>';
          content += "</div>";

          content +=
            '<div style="background: #f8f9fa; padding: 20px; border-radius: 6px; margin-bottom: 25px;">';
          content +=
            '<div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; font-size: 0.9em;">';
          content +=
            "<div><strong>æŠ¥è¡¨åç§°:</strong> " + report.name + "</div>";
          content +=
            "<div><strong>ç”Ÿæˆæ—¶é—´:</strong> " +
            new Date().toLocaleString("zh-CN") +
            "</div>";
          content += "<div><strong>æ–‡ä»¶æ ¼å¼:</strong> PDF / Excel</div>";
          content += "<div><strong>æ–‡ä»¶å¤§å°:</strong> çº¦ 2.5MB</div>";
          content += "</div>";
          content += "</div>";

          content += '<div style="display: flex; gap: 10px;">';
          content +=
            '<button class="btn btn-primary" onclick="showAlert(\'ä¸‹è½½åŠŸèƒ½å¼€å‘ä¸­\')" style="flex: 1;">ä¸‹è½½PDF</button>';
          content +=
            '<button class="btn btn-secondary" onclick="showAlert(\'ä¸‹è½½åŠŸèƒ½å¼€å‘ä¸­\')" style="flex: 1;">ä¸‹è½½Excel</button>';
          content +=
            '<button class="btn btn-outline" onclick="showAlert(\'é¢„è§ˆåŠŸèƒ½å¼€å‘ä¸­\')" style="flex: 1;">åœ¨çº¿é¢„è§ˆ</button>';
          content += "</div>";

          content += "</div>";

          showModal("æŠ¥è¡¨ç”Ÿæˆå®Œæˆ", content);
        }, 2000);
      }

      // é¡µé¢åˆå§‹åŒ–
      document.addEventListener("DOMContentLoaded", function () {
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        if (sessionStorage.getItem("isLoggedIn") !== "true") {
          window.location.href = "login.html";
          return;
        }

        renderReports();
      });
    </script>
  </body>
</html>
